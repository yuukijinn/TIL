# IAMについて

---

awsではまず最初に **ルートユーザー**を作成する。
これはaws上全てのリソースにアクセスできる最強のアカウント。
しかしawsには **最小権限の原則**があるので、基本的にこのルートユーザは普段使用しないようにするべき。そこで用いられるのが **IAM**というもの。

**IAM**では対象にどのような権限を与えるのかというのを管理することができる。

- IAMユーザー
- IAMグループ
- IAMロール

の３種類がある。

- **IAMユーザー**

  これは個人専用のアカウント。

  それぞれのユーザーに対してアクセス権限(ポリシー)を設定することができる。

- **IAMグループ**

  権限の共有を効率化するための仕組み。

  あらかじめグループとしてのポリシーを設定しておき、そのグループに人を突っ込んでいくことによって、共通の権限を楽に与えて管理することができる。

  IAMグループは階層構造を持たないので作成の際には注意して作成する必要がある

- **IAMロール**

  これは主に、awsのサービスに対して、権限を与えて管理するための仕組み。

  awsでは最小権限の原則に基づいて、それぞれのサービス(ex: ec2からs3へのアクセス)におけるアクセスの権限はデフォルトでなしになっている。
  リソース間のアクセスを許可するために、例えばec2に対して、IAMロールを付与し、s3へのアクセスの権限を与える。

  また、外部のアカウントなどに対して、一時的に権限を与えるという用途でも用いられる。
  これに関しては、setcredentialでおこなっている作業が該当。
  IAMロールの権限の期限はデフォルトで3600秒(1h)となってる。


awsにおいてはまず前提として、人やサービスという括りを同じ物として考えた上で、物同士のアクセスにおいては必ず権限が必要である。
その権限を付与するための方法として、以下のような形がある。

| **IAMの種類** | **主な対象** | **権限付与方法** | **特徴** |
| --- | --- | --- | --- |
| IAMユーザー | 個人ユーザー | 直接ポリシーを設定 | 個別の権限管理が可能 |
| IAMグループ | ユーザーの集合 | グループにポリシーを設定し、ユーザーをグループに所属させる | 共通の権限を効率的に管理可能（階層構造なし） |
| IAMロール | AWSサービス、外部アカウント | サービスやアカウントにロールを付与 | 一時的な権限付与が可能（デフォルト期限1時間） |

<aside>
注：AWSの最小権限の原則に基づき、デフォルトではすべての権限が無効になっています。

</aside>

**IAMポリシー**

上で挙げたそれぞれの種類において、その権限や設定などをIAMポリシーという。

IAMポリシーはJSON形式で記述される。